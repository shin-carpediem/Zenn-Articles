---
title: "Swiftで非同期処理の結果を受け取る方法 #その1"
emoji: "🕊"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["swift", "非同期処理"]
published: false
---

## 非同期処理って難しい

プログラム処理のパターンを時間軸でざっくり分けると、同期処理と非同期処理の 2 パターンがあります。同期処理は上から順にコードが実行されていくので、直感的ですよね。
では非同期処理はどうでしょうか。非同期処理の話になると、途端に、`コールバック`やら`Reactive Programming`やら難しい単語がたくさん出てきて、とっつきにくい内容だと私は感じてしまいます。
非同期処理の理解を難しくしているのは、処理の中身ではなく、その結果の受け取り方がパターンによって様々だからです。パターン毎の処理結果の受け取り方の違いと、長所・短所を知っていれば、非同期処理に対する恐怖感も拭いやすいです。

## パターンは全部で 7 つ

Combine や async/await が使える環境なら、使うのがオススメというのが私個人の考えです。

| パターン                    | 特徴                                 | 可読性                                                    | 使い所                                                                                                          |
| :-------------------------- | :----------------------------------- | :-------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------- |
| `escaping`                  | コールバックで処理結果を返す         | ○<br>ネストは増えるがシンプル                             | 愚直に書きたい時                                                                                                |
| `delegate`                  | 処理の一部を別の所で実装してもらえる | △<br>書いた内容がどのタイミングで実行されるか知る必要あり | `UITableViewDelegate`等、UIKit のメソッドを使う必要がある時や、View 層と Presentation(Controller)層を跨ぎたい時 |
| `RxSwift`                   | 非同期処理をより自由に扱える         | ◎<br>非同期処理を同期処理ぽく書ける                       | アプリのサポート範囲が iOS 8~12 の時                                                                            |
| `Combine`                   | RxSwift よりも楽に書ける             | ◎<br>RxSwift と書き方が似ている                           | アプリのサポート範囲が iOS 13 以上の時                                                                          |
| `async / await`             | Combine よりも楽に書ける             | ◎<br>非同期処理を同期処理ぽく書ける                       | アプリのサポート範囲が iOS 15 以上の時                                                                          |
| `KVO (Key-Value Observing)` | 特定範囲に DI できる                 | △<br>依存関係が分かり辛い                                 | アプリのサポート範囲に iOS 12 を含む時、かつ View 層内で使いたい時                                              |
| `NotificationCenter`        | アプリ全体に DI できる               | △<br>依存関係が分かり辛い                                 | アプリ全体で必要な状態を作りたい時                                                                              |

---

#### 参考記事
